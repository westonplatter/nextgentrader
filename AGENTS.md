<!-- This file was auto-generated by aps (https://github.com/westonplatter/aps) -->

# NextGenTrader

This is a agentic project enabling one person to operate as an quick and nimble trading desk.

## Docs Index Rule

If any `docs/*.md` file is added, modified, renamed, or deleted (excluding `docs/_index.md`), update `docs/_index.md` in the same change.

## Python

### Verifying Code
- Never run Python or shell to test code
- Use Ruff for fast feedback during edits
- Require Pyright to pass before declaring changes correct

### Code Organization
- Always place python imports at top of file
- Never import packages in functions

### Principles
1. **Use `uv run python`** - Always execute Python commands via `uv run python ...` to ensure consistent dependency management and virtual environment isolation.
2. **Type hints everywhere** - Use type annotations for function signatures and variables to improve code clarity and enable better static analysis.
3. **Prefer standard library** - Use Python's standard library when possible before reaching for third-party packages. This reduces dependencies and improves portability.
4. **Explicit over implicit** - Write clear, readable code that makes intent obvious. Avoid magic methods and metaprogramming unless there's a compelling reason.

### Progress Bars
Use `tqdm` for user-facing scripts or long-running processes to provide feedback.
To keep log statements above the progress bar (preventing visual conflicts):
```python
from tqdm import tqdm

for item in tqdm(items, desc="Processing"):
    # Use tqdm.write() instead of print() for log messages
    tqdm.write(f"Processing {item.name}")
    process(item)
```

For logging module integration:

```python
import logging
from tqdm import tqdm

# Redirect logging through tqdm
class TqdmLoggingHandler(logging.Handler):
    def emit(self, record):
        tqdm.write(self.format(record))

logging.basicConfig(handlers=[TqdmLoggingHandler()], level=logging.INFO)
```

## Pandas

### Principles

1. **Use vectorized operations** - Avoid iterating over rows with `for` loops or `.iterrows()`. Use built-in vectorized methods for performance.

2. **Chain methods** - Use method chaining (`.pipe()`, `.assign()`, `.query()`) for readable, declarative transformations.

3. **Be explicit with dtypes** - Specify dtypes when reading data and use `.astype()` to enforce types. This prevents silent type coercion bugs.

4. **Prefer `.loc` and `.iloc`** - Use explicit indexing instead of chained indexing to avoid `SettingWithCopyWarning` and ensure predictable behavior.

5. **Handle missing data intentionally** - Use `.isna()`, `.fillna()`, or `.dropna()` explicitly. Never assume data is complete.

6. **Use `.copy()` when needed** - Create explicit copies when modifying subsets to avoid unintended mutations to the original DataFrame.

## Docs Style

Compact, high signal to noise write descriptions optimized for an engineer-to-engineer dialogue.

- Be concise. Prefer short sentences and direct statements.
- Focus on actionable information. Avoid filler, marketing, and verbosity.
- Use plain language and concrete terms.
- Keep sections small; remove anything nonessential.
- Use bullets for quick scanning; avoid long paragraphs.
- Favor commands/examples over prose.
- State assumptions explicitly when needed.
- Avoid redundancy.

## Pull Requests

### Pull Request Description
When opening or updating pull requests, include the following write-up in the PR body.

- Summary (required). Less than 100 words. What changed and why (not a file list)
- Features (optional). Bullet list of new behavior/capabilities, or "N/A".
- Refactoring (optional). Explain what changed and why. Describe new code structure and patterns.
- Fixes (optional). Bullet list of bugs corrected/remediation, or "N/A".
- Documentation (required if behavior changed)
- Additional notes (when applicable). Link issue(s) or external resources.
